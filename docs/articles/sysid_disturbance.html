<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Closed-loop disturbance signal estimation | TimeSeriesAnalysis reference documentation </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Closed-loop disturbance signal estimation | TimeSeriesAnalysis reference documentation ">
    <meta name="generator" content="docfx 2.59.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="closed-loop-disturbance-signal-estimation">Closed-loop disturbance signal estimation</h1>

<h2 id="what-is-it">What is it?</h2>
<p>The <em>disturbance</em> is an additive signal that moves the output of the given unit process.
Counter-acting disturbances are the very reason that feedback controllers are used, they
observe the deviation between setpoint and measurement of the plant output, and change
one-or more inputs to counter-act the disturbance.</p>
<p><img src="images/sysid_disturbance_system.png" alt="System definitions"></p>
<h3 id="example-step-disturbance">Example: step disturbance</h3>
<p>Consider a step disturbance acting on a system without feedback</p>
<p><img src="images/sysid_disturbance_ex1.png" alt="ex1"></p>
<p>The feedback is directly fed through to the output, while the input is constant.</p>
<p>Now consider and compare the same step disturbance, but this time a PID-controller counter-acts the disturbance</p>
<p><img src="images/sysid_disturbance_ex2.png" alt="ex1"></p>
<p>The disturbance initally appears on the system output, then is slowly counter-acted by change of the manipulated
variable <code>u</code> by feedback control, thus moving the effect of the disturbance from the output <code>y</code> to the
manipualted <code>u</code>.</p>
<p>Observing the offset between setpoint and measurement gives a <em>&quot;high-frequency&quot;</em> <code>d_HF</code> response and is seen
first, while the change in <code>u</code> is gradual and <em>&quot;low-frequency&quot;</em> <code>d_LF</code> and the approach
will attempt to combine the two <img src="images/sysid_disturbance_ex2.png" alt="ex3"></p>
<p><em>The aim of this section is to develop an algorithm to estimate the the un-meausred disturbance <code>d</code>
indirectly based on the measured <code>u</code> and <code>e</code></em></p>
<h2 id="why-is-distrubance-signal-estimation-important">Why is distrubance signal estimation important?</h2>
<p>Disturbances are the &quot;action&quot; or &quot;excitation&quot; that causes feedback-controlled systems to
move, if these signals could be estimated, then a disturbance could be &quot;played back&quot; in
a simulation and different changes to the control system could be assesed and compared.</p>
<p>Describing the disturbance signal is also important for identifying the other components
of a feedback-controlled system correctly, as disturbances are &quot;non-white&quot; noise that tends
to skew estimates (destroying the regression accuracy) if not accounted for.</p>
<h2 id="what-are-the-challenges">What are the challenges?</h2>
<p>The challenge in describing disturbances in feedback-systems is that the feedback aims
to counter-act the very disturbance which needs to be described by changing the manipulated
variable.</p>
<p>Thus, the effect of the disturbance is in the short-term seen on the system output <code>y</code>,
but in the long-term the effects of the disturbance are seen on the feedback-manipulated variable
<code>u</code>. The PID-controller will act with some time-constant on <code>u</code>,and this change in <code>u</code>
will again act back on the output <code>y</code> with a delay or dynamic behavior that is
given by the process(decribed by the process model.) To know what amplitude a disturbance has,
requires knowledge of how much effect (or &quot;gain&quot;) the change in manipulated variable u will
have caused on the output <code>y</code>.</p>
<p><em>Thus the two tasks of estimating the disturbance and estimating the process model are linked</em>,
and thus they likely need to be solved <em>jointly</em>.</p>
<h2 id="approach">Approach</h2>
<p>The chosen approach to solve the linked problem of solving for
process model and disturbancee signal is <em>sequential</em>(as opposed to simulatenous),
meaning that the algorithm first estimates a disturbance signal, then
what process model best describes the data for the given disturbance signal, then the estimate
of the disturbance is updated using the model, back-and-forth until both estimates hopefully converge.</p>
<p>Let the control deviation <code>e</code> be defined as</p>
<pre><code>e = (y_meas-y_set)
</code></pre>
<p>Further, the disturbance is divded into a high-frequency part <code>d_HF</code>
and a low-frequency part <code>d_LF</code>,
and it is assumed that</p>
<pre><code>d = d_HF+d_LF = d_HF(e)+ d_LF(u)
</code></pre>
<p><code>d_LF</code> will in general also be a function of the process model, especially the process gain.</p>
<h3 id="first-model-free-estimate">First, model-free estimate</h3>
<p>In order to initalize the sequential estimation, a model-free estimate of the disturbance
is require initally.</p>
<p>For the first iteration, all process dynamics and nonlinearities are neglected,
a linear static model essentially boils down to estimating the process gain.</p>
<p><img src="images/sysid_disturbance_init.png" alt="init"></p>
<p>This first estimate of the process gain <code>G</code> in a linear model <code>y = G x u</code>
is found by the approximation</p>
<pre><code>G = max(e)/(max(u)-min(u)) 
</code></pre>
<h3 id="separating-the-state-of-the-system-from-the-output">Separating the state of the system from the output</h3>
<p>Let the state <code>X</code> be defined as the output minus the disturbance:</p>
<pre><code>y = x + d
</code></pre>
<p>When solving the process model for a given disturbance, the identification is
done on the un-meausred <code>x</code> found from</p>
<pre><code>x = y-d
</code></pre>
<h3 id="algorithm">Algorithm</h3>
<pre><code>(In the case of no setpoint changes in the data set)
- Guess the process gain, as shown above
- Disturbance(&quot;run1&quot;):Estiamte the disturbance for the linear static process gain
- Model(&quot;run1&quot;):Subtract the above disturbance signal from y, and run UnitIdentifier.IdentifyLinearAndStatic to estimate
- Disturbance(&quot;run2&quot;):Estimate the disturbance using the above process model 
- Model(&quot;run2&quot;): Subtract the above disturbance signal from y, and run UnitIdentifier.Linear
- Disturbance(&quot;run3&quot;):Estimate the disturbance using the above process model 
- Model(&quot;run3&quot;): Subtract the above disturbance signal from y, and run UnitIdentifier.Linear
</code></pre>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
